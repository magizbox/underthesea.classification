Lỗi khi xây dựng chương trình quản lý điện thoại (1)
Toi xay dung chuong trinh quan ly dien thoai bang ngon ngu Visual Basic 6.0 , du lieu bang Access. Khi khoi dong bam F5 chuong trinh bao loi : "rs.Open Str, cn, adOpenKeyset, adLockOptimistic, adCmdText". Mac du da kiem tra rat ky. Xin hay giup do toi. Tran trong cam on!
Dung Tran Van
Hồi âm:
PrivateSubCommand1_Click()DimconConnectionAsNewADODB.ConnectionDimcmdCommandAsNewADODB.CommandDimrstRecordSetAsNewADODB.Recordset 'File database phai cung cap thu muc voi file chay .execonConnection.ConnectionString="Provider=Microsoft.Jet.OLEDB.4.0;Data Source="_ App.Path"\""database.mdb;Mode=Read|Write"'Define the location of the cursor engine, in this case we are opening an Access database'and adUseClient is our only choice.conConnection.CursorLocation=adUseClient'Opens our connection using the password "Admin" to access the database. If there was no password'protection on the database this field could be left out.conConnection.Open'Defines our command object' .ActiveConnection tells the command to use our newly created command object.' .CommandText tells the command how to get the data, in this case the command' will evaluate the text as an SQL string and we will return all' records from a table called tabTestTable' .CommandType tells the command to evaluate the .CommandText property as an SQL string.WithcmdCommand .ActiveConnection=conConnection .CommandText="SELECT  FROM tabTestTable;" .CommandType=adCmdTextEndWith'Defines our RecordSet object.' .CursorType sets a static cursor, the only choice for a client side cursor' .CursorLocation sets a client side cursor, the only choice for an Access database' .LockType sets an optimistic lock type' .Open executes the cmdCommand object against the data source and stores the' returned records in our RecordSet object.WithrstRecordSet .CursorType=adOpenStatic .CursorLocation=adUseClient .LockType=adLockOptimistic .OpencmdCommandEndWith'Firstly test to see if any records have been returned, if some have been returned then'the .EOF property of the RecordSet will be false, if none have been returned then the'property will be true.IfrstRecordSet.EOF=FalseThen 'Move to the first record rstRecordSet.MoveFirst 'Lets move through the records one at a time until we reach the last record 'and print out the values of each field Do 'Access the field values using the fields collection and print them to a message box. 'In this case I do not know what you might call the columns in your database so this 'is the safest way to do it. If I did know the names of the columns in your table 'and they were called "Column1" and "Column2" I could reference their values using: ' rstRecordSet!Column1 ' rstRecordSet!Column2 MsgBox"Record "rstRecordSet.AbsolutePosition" "_ rstRecordSet.Fields(0).Name"="rstRecordSet.Fields(0)" "_ rstRecordSet.Fields(1).Name"="rstRecordSet.Fields(1) 'Move to the next record rstRecordSet.MoveNext LoopUntilrstRecordSet.EOF=True 'Add a new record WithrstRecordSet .AddNew .Fields(0)="New" .Fields(1)="Record" .Update EndWith 'Move back to the first record and delete it rstRecordSet.MoveFirst rstRecordSet.Delete rstRecordSet.Update 'Close the recordset rstRecordSet.CloseElse MsgBox"No records were returned using the query "cmdCommand.CommandTextEndIf'Close the connectionconConnection.Close'Release your variable referencesSetconConnection=NothingSetcmdCommand=NothingSetrstRecordSet=NothingEndSub

